{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@nodeloc/whisper/webpack/bootstrap","webpack://@nodeloc/whisper/webpack/runtime/compat get default export","webpack://@nodeloc/whisper/webpack/runtime/define property getters","webpack://@nodeloc/whisper/webpack/runtime/hasOwnProperty shorthand","webpack://@nodeloc/whisper/webpack/runtime/make namespace object","webpack://@nodeloc/whisper/external root \"flarum.core.compat['app']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['extend']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['components/IndexPage']\"","webpack://@nodeloc/whisper/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nodeloc/whisper/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/Model']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/mixin']\"","webpack://@nodeloc/whisper/./src/forum/models/Message.js","webpack://@nodeloc/whisper/./src/forum/models/Conversation.js","webpack://@nodeloc/whisper/./src/forum/models/ConversationUser.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['models/User']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['Model']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/Page']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/Button']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/Component']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@nodeloc/whisper/./src/forum/components/MessageText.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/withAttr']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['forum/app']\"","webpack://@nodeloc/whisper/./src/forum/components/ConversationView.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/userOnline']\"","webpack://@nodeloc/whisper/./src/forum/components/UserListItem.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['forum/components/Search']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/utils/extract']\"","webpack://@nodeloc/whisper/./src/forum/components/RecipientSearch.js","webpack://@nodeloc/whisper/./src/forum/components/StartConversationModal.js","webpack://@nodeloc/whisper/./src/forum/components/ConversationsList.js","webpack://@nodeloc/whisper/./src/forum/components/ConversationsPage.js","webpack://@nodeloc/whisper/./src/forum/components/ConversationViewPage.js","webpack://@nodeloc/whisper/external root \"flarum.core.compat['utils/Stream']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['utils/UserControls']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['components/Button']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['common/extend']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['forum/components/HeaderSecondary']\"","webpack://@nodeloc/whisper/external root \"flarum.core.compat['forum/components/NotificationsDropdown']\"","webpack://@nodeloc/whisper/./src/forum/components/ConversationsDropdown.js","webpack://@nodeloc/whisper/./src/forum/index.js","webpack://@nodeloc/whisper/./src/forum/addConversationsDropdown.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/IndexPage'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/mixin'];","import Model from 'flarum/common/Model';\nimport mixin from 'flarum/common/utils/mixin';\n\nexport default class Message extends mixin(Model, {\n  message: Model.attribute('message'),\n  user: Model.hasOne('user'),\n  isHidden: Model.attribute('isHidden'),\n  createdAt: Model.attribute('createdAt', Model.transformDate),\n  conversation: Model.hasOne('conversation'),\n  number: Model.hasOne('number'),\n}) {\n  apiEndpoint() {\n    return `/whisper/messages${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\nimport mixin from 'flarum/common/utils/mixin';\n\nexport default class Conversation extends mixin(Model, {\n  messages: Model.hasMany('messages'),\n  recipients: Model.hasMany('recipients'),\n  totalMessages: Model.attribute('totalMessages'),\n  notNew: Model.attribute('notNew'),\n  createdAt: Model.attribute('createdAt', Model.transformDate),\n  updatedAt: Model.attribute('updatedAt', Model.transformDate),\n}) {\n  apiEndpoint() {\n    return `/whisper/conversations${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","import Model from 'flarum/common/Model';\nimport mixin from 'flarum/common/utils/mixin';\n\nexport default class ConversationUser extends mixin(Model, {\n  conversation: Model.hasOne('conversation'),\n  user: Model.hasOne('user'),\n\n  userId: Model.attribute('userId'),\n  conversationId: Model.attribute('conversationId'),\n  lastRead: Model.attribute('lastRead'),\n}) {}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/humanTime'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","import Component from 'flarum/common/Component';\n\nexport default class MessageText extends Component {\n  static initAttrs(attrs) {\n    attrs.className = attrs.className || '';\n    attrs.content = attrs.content || '';\n    attrs.preview = attrs.preview || false;\n  }\n\n  view() {\n    return <div className={this.attrs.className} />;\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    if (this.attrs.preview) {\n      let preview;\n      const updatePreview = () => {\n        const content = this.attrs.content;\n\n        if (preview === content) return;\n\n        preview = content;\n\n        s9e.TextFormatter.preview(content || '', vnode.dom);\n      };\n      updatePreview();\n\n      this.updateInterval = setInterval(updatePreview, 50);\n    } else {\n      s9e.TextFormatter.preview(this.attrs.content, vnode.dom);\n    }\n  }\n\n  onremove() {\n    clearInterval(this.updateInterval);\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/withAttr'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport MessageText from './MessageText';\nimport Stream from 'flarum/common/utils/Stream';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport icon from 'flarum/common/helpers/icon';\nimport app from 'flarum/forum/app';\n\nexport default class ConversationView extends Component {\n  oninit(vnode) {\n    this.loading = true;\n    this.vnode = vnode;\n    this.mobile = vnode.attrs.mobile;\n    this.idParam = m.route.param('id');\n    this.firstLoad = true;\n\n    this.typingTimeout = true;\n\n    this.sendTimeout = true;\n\n    const interval1 = () => {\n      this.typingTimeout = true;\n      setTimeout(() => {\n        interval1();\n      }, 5000);\n    };\n\n    const interval2 = () => {\n      if (this.typingTime < new Date(Date.now() - 6000)) {\n        this.typing = false;\n        m.redraw();\n      }\n      setTimeout(() => {\n        interval2();\n      }, 6000);\n    };\n\n    this.interval3 = () => {\n      if (this.timer === 0) {\n        this.sendTimeout = true;\n        m.redraw();\n        return;\n      }\n      this.timer--;\n      if (this.timer >= 0) {\n        setTimeout(() => {\n          this.interval3();\n        }, 1000);\n      }\n    };\n\n    interval1();\n    interval2();\n\n    this.typing = false;\n\n    this.conversation = this.conversation ? this.conversation : vnode.attrs.conversation;\n\n    this.initPost();\n  }\n\n  initPost() {\n    this.newMessageCount = 0;\n\n    this.load();\n\n    this.messageContent = Stream('');\n\n    return new Promise(() => {\n      setTimeout(() => {\n        $('.chat-history').animate({ scrollTop: $('.chat-history').prop('scrollHeight') }, 1000);\n      }, 500);\n    });\n  }\n\n  onremove() {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        channels.user.unbind('typing');\n        channels.user.unbind('newMessage');\n      });\n    }\n  }\n\n  onupdate() {\n    $('.chat-history').scroll(() => {\n      if (!this.notNew) {\n        let pos = $('.chat-history').scrollTop();\n        if (pos === 0) {\n          const firstMsg = $('.message-content:first');\n          this.getMessages(app.cache.messages[this.conversation.id()].length);\n          if (!this.notNew) {\n            $('.chat-history').scrollTop(firstMsg.offset().top);\n          }\n        }\n      }\n    });\n  }\n\n  onbeforeupdate() {\n    $('.UserListItem')\n      .off('click')\n      .on('click', (e) => {\n        this.conversation = app.cache.conversations[$(e.currentTarget).attr('id')];\n        this.index = $(e.currentTarget).attr('id');\n        this.notNew = false;\n        this.cipher = null;\n        this.oninit(this.vnode);\n        m.redraw();\n      });\n\n    $('#MessageTextArea')\n      .off()\n      .on('keydown', (e) => {\n        if (e.keyCode === 13 && app.forum.attribute('whisperReturnKey')) {\n          $('#MessageTextArea').prop('disabled', true);\n          this.sendMessage();\n        }\n      });\n  }\n\n  oncreate() {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        channels.user.bind('newMessage', (data) => {\n          if (\n            parseInt(data.conversationId) === parseInt(this.conversation.id()) &&\n            $('.MessagesDropdown').children('.Dropdown-menu').is(':visible')\n          ) {\n            const message = {\n              id: Stream(data.id),\n              message: Stream(data.message),\n              user: Stream(this.user),\n              createdAt: Stream(data.createdAt),\n            };\n            this.decryptMessages([message]);\n            this.newMessageCount++;\n            this.typing = false;\n            m.redraw();\n            $('.chat-history').animate({ scrollTop: $('.chat-history').prop('scrollHeight') }, 1000);\n          }\n        });\n\n        channels.user.bind('typing', (data) => {\n          if (parseInt(data.conversationId) === parseInt(this.conversation.id())) {\n            let list = $('.chat-history');\n\n            let scrollMore = false;\n\n            if (list.scrollTop() + list.innerHeight() >= list[0].scrollHeight - 50) {\n              scrollMore = true;\n            }\n\n            this.typing = true;\n            this.typingTime = new Date();\n            m.redraw();\n\n            if (scrollMore) {\n              list.animate({ scrollTop: $('.chat-history').prop('scrollHeight') }, 400);\n            }\n          }\n        });\n\n        channels.user.bind('readMessage', (data) => {\n          if (parseInt(data.conversationId) === parseInt(this.conversation.id())) {\n            this.recipient.lastRead = m.prop(data.number);\n            m.redraw();\n          }\n        });\n      });\n    }\n  }\n\n  view() {\n    this.messages = app.cache.messages ? app.cache.messages[this.conversation.id()] : [];\n    return (\n      <div style={this.idParam && this.mobile ? 'width: 100%' : ''} className=\"chat\">\n        <div className=\"chat-header clearfix\">\n          {avatar(this.user)}\n\n          <div className=\"chat-about\">\n            <div className=\"chat-with\">{app.translator.trans('nodeloc-whisper.forum.chat.chat_with', { username: username(this.user) })}</div>\n            <div className=\"chat-num-messages\">\n              {app.translator.trans(\n                'nodeloc-whisper.forum.chat.messages_' + (parseInt(this.conversation.totalMessages()) > 1 ? 'multiple' : 'single'),\n                { count: this.conversation.totalMessages() + this.newMessageCount }\n              )}\n            </div>\n          </div>\n        </div>\n\n        {this.messages && this.messages.length > 0 && !this.loading ? (\n          [\n            <div className=\"chat-history\">\n              <ul>\n                {this.notNew ? <li className=\"startConvo\">{app.translator.trans('nodeloc-whisper.forum.chat.start_of_conversation')}</li> : ''}\n                {this.messages\n                  ? this.messages\n                      .filter((message, index, self) => index === self.findIndex((t) => t.message() === message.message()))\n                      .sort((a, b) => {\n                        return a.createdAt() - b.createdAt();\n                      })\n                      .map((message, i) => {\n                        const myMessage = parseInt(message.user().id()) === parseInt(app.session.user.id());\n                        return (\n                          <li className=\"clearfix message-content\">\n                            <div className={'message-data ' + (myMessage ? 'align-right' : '')}>\n                              <div className={'avatar-inline ' + (myMessage ? 'me' : 'other')}>\n                                {avatar(myMessage ? app.session.user : message.user())}\n                              </div>\n                              <span className=\"message-data-name\">{username(myMessage ? app.session.user : message.user())}</span>\n                              <span className=\"message-data-time\">{humanTime(message.createdAt())}</span>\n                            </div>\n                            <MessageText\n                              content={message.message()}\n                              className={'message ' + (myMessage ? 'my-message float-right' : 'other-message')}\n                            />\n                            {myMessage ? (\n                              parseInt(this.recipient.lastRead()) >= parseInt(message.data.attributes.number) ? (\n                                <span className=\"message-read\">{icon('fas fa-check')}</span>\n                              ) : (\n                                ''\n                              )\n                            ) : (\n                              ''\n                            )}\n                          </li>\n                        );\n                      })\n                  : ''}\n                {this.messageContent() ? (\n                  <li>\n                    <MessageText content={this.messageContent()} className={'message my-message float-right message-preview'} preview={true} />\n                  </li>\n                ) : (\n                  ''\n                )}\n                {this.typing ? (\n                  <li>\n                    <div className=\"tiblock\">\n                      <div className=\"tidot\"></div>\n                      <div className=\"tidot\"></div>\n                      <div className=\"tidot\"></div>\n                    </div>\n                  </li>\n                ) : (\n                  ''\n                )}\n              </ul>\n            </div>,\n          ]\n        ) : (\n          <LoadingIndicator display=\"block\" size=\"medium\" />\n        )}\n\n        <form className=\"chat-message clearfix\">\n          <textarea\n            id=\"MessageTextArea\"\n            value={this.messageContent()}\n            oninput={withAttr('value', this.typingPush.bind(this))}\n            placeholder={app.translator.trans('nodeloc-whisper.forum.chat.text_placeholder')}\n            rows=\"3\"\n          ></textarea>\n\n          {Button.component(\n            {\n              onclick: this.sendMessage.bind(this),\n              className: 'Button Button--primary',\n              disabled: !this.messageContent() || !this.sendTimeout,\n            },\n            app.translator.trans('nodeloc-whisper.forum.chat.send')\n          )}\n        </form>\n      </div>\n    );\n  }\n\n  typingPush(value) {\n    this.messageContent(value);\n    m.redraw();\n    if (this.typingTimeout) {\n      app\n        .request({\n          method: 'POST',\n          url: app.forum.attribute('apiUrl') + '/whisper/messages/typing',\n          body: {\n            conversationId: this.conversation.id(),\n            userId: this.user.id(),\n          },\n        })\n        .then(() => {\n          this.typingTimeout = false;\n        });\n    }\n  }\n\n  sendMessage() {\n    if (this.sendTimeout) {\n      if (this.messageContent() === '' || !this.messageContent().replace(/\\s/g, '').length) return;\n      this.sendTimeout = false;\n      this.timer = 1;\n      this.interval3();\n      this.newMessageCount++;\n      app.store\n        .createRecord('messages')\n        .save({\n          messageContents: this.messageContent(),\n          conversationId: this.conversation.id(),\n        })\n        .then((message) => {\n          app.cache.messages[this.conversation.id()].push(message);\n          m.redraw();\n          this.messageContent('');\n          $('.chat-history').animate({ scrollTop: $('.chat-history').prop('scrollHeight') }, 500);\n          app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/whisper/messages/read',\n            body: {\n              conversationId: this.conversation.id(),\n              messageId: message.id(),\n            },\n          });\n        });\n    }\n  }\n\n  getMessages(offset = 0) {\n    if (!this.notNew) {\n      app.store\n        .find('whisper/messages', this.conversation.id(), { offset })\n        .then((results) => {\n          delete results.payload;\n          if (this.firstLoad) {\n            const oldNumber = this.meRecipient.lastRead();\n            app\n              .request({\n                method: 'POST',\n                url: app.forum.attribute('apiUrl') + '/whisper/messages/read',\n                body: {\n                  conversationId: this.conversation.id(),\n                  messageId: results[0].id(),\n                },\n              })\n              .then((response) => {\n                const newNumber = response.data.attributes.lastRead;\n                let unreadMessages = 0;\n                const lastUnreadMessage = app.session.user.unreadMessages();\n\n                if (lastUnreadMessage !== 0) unreadMessages = lastUnreadMessage - (newNumber - oldNumber);\n\n                if (unreadMessages >= 0) {\n                  app.session.user.pushAttributes({\n                    unreadMessages,\n                  });\n\n                  m.redraw();\n                }\n\n                this.firstLoad = false;\n              });\n          }\n          app.cache.messages[this.conversation.id()].push(...results);\n          if (results.length < 20) {\n            this.notNew = true;\n          }\n        })\n        .then(() => {\n          this.loading = false;\n          m.redraw();\n        });\n    }\n  }\n\n  load() {\n    this.loading = true;\n    m.redraw();\n\n    if (!app.cache.messages) {\n      app.cache.messages = [];\n    }\n\n    this.conversation.recipients().map((recipient) => {\n      if (parseInt(recipient.user().id()) !== parseInt(app.session.user.id())) {\n        this.user = recipient.user();\n        this.recipient = recipient;\n      } else {\n        this.meRecipient = recipient;\n      }\n    });\n\n    if (!app.cache.messages[this.conversation.id()]) {\n      app.cache.messages[this.conversation.id()] = [];\n    }\n\n    this.getMessages();\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/userOnline'];","import Component from 'flarum/common/Component';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport userOnline from 'flarum/common/helpers/userOnline';\nimport app from 'flarum/forum/app';\n\nexport default class UserListItem extends Component {\n  oninit(vnode) {\n    this.conversation = vnode.attrs.conversation;\n    this.index = vnode.attrs.i;\n    this.active = vnode.attrs.active;\n    this.loading = true;\n\n    this.conversation.recipients().map((recipient) => {\n      if (parseInt(recipient.user().id()) !== parseInt(app.session.user.id())) {\n        this.user = recipient.user();\n        this.loading = false;\n        m.redraw();\n      }\n    });\n\n    const interval2 = () => {\n      if (this.typingTime < new Date(Date.now() - 6000)) {\n        this.typing = false;\n        m.redraw();\n      }\n      setTimeout(() => {\n        interval2();\n      }, 6000);\n    };\n\n    interval2();\n\n    super.oncreate(vnode);\n  }\n\n  onremove(vnode) {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        channels.user.unbind('typing');\n      });\n    }\n\n    super.onremove(vnode);\n  }\n\n  oncreate(vnode) {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        channels.user.bind('typing', (data) => {\n          if (parseInt(data.conversationId) === parseInt(this.conversation.id())) {\n            this.typing = true;\n            this.typingTime = new Date();\n            m.redraw();\n          }\n        });\n      });\n    }\n\n    super.oncreate(vnode);\n  }\n\n  view(vnode) {\n    if (this.loading || !this.user) return null;\n\n    const onclick = (e) => {\n      this.attrs.onclick(e);\n      this.active = this.conversation.id() === app.cache.conversations[$(e.currentTarget).attr('id')].id();\n    };\n\n    return (\n      <li id={this.index} className={this.active ? 'UserListItem active' : 'UserListItem'} onclick={onclick}>\n        <div className=\"UserListItem-content\">\n          {avatar(this.user)}\n          <div className=\"info\">\n            {username(this.user)}\n            {userOnline(this.user)}\n          </div>\n          {!!this.typing && (\n            <div className=\"tiblock\">\n              <div className=\"tidot\"></div>\n            </div>\n          )}\n        </div>\n      </li>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Search'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/highlight'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extract'];","import Search from 'flarum/forum/components/Search';\nimport UserSearchSource from './UserSearchSource';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport recipientLabel from './recipientLabel';\nimport Stream from 'flarum/common/utils/Stream';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport app from 'flarum/forum/app';\n\nexport default class RecipientSearch extends Search {\n  oninit(attrs) {\n    this.value = Stream();\n    super.oninit(attrs);\n  }\n\n  updateMaxHeight() {\n    // stub\n  }\n\n  view() {\n    if (typeof this.value() === 'undefined') {\n      this.value('');\n    }\n\n    const loading = this.value() && this.value().length >= 3;\n\n    if (!this.sources) {\n      this.sources = this.sourceItems().toArray();\n    }\n\n    return (\n      <div className=\"AddRecipientModal-body\">\n        {app.cache.conversationsRecipient === null ? (\n          <div className=\"AddRecipientModal-form-input\">\n            <input\n              className={classList('RecipientsInput FormControl', {\n                open: !!this.value(),\n                focused: !!this.value(),\n                active: !!this.value(),\n                loading: !!this.loadingSources,\n              })}\n              config={function (element) {\n                element.focus();\n              }}\n              type=\"search\"\n              placeholder={extractText(app.translator.trans('nodeloc-whisper.forum.modal.search_recipients'))}\n              value={this.value()}\n              oninput={withAttr('value', this.value)}\n              onfocus={() => (this.hasFocus = true)}\n              onblur={() => (this.hasFocus = false)}\n              onkeyup={() => {\n                clearTimeout(this.typingTimer);\n                this.doSearch = false;\n                this.typingTimer = setTimeout(() => {\n                  this.doSearch = true;\n                  m.redraw();\n                }, 900);\n              }}\n              onkeydown={() => {\n                clearTimeout(this.typingTimer);\n              }}\n            />\n            <ul\n              className={classList('Dropdown-menu Search-results fade', {\n                in: !!loading,\n              })}\n              onclick={() => {\n                const target = this.$('.SearchResult.active');\n\n                this.addRecipient(target.data('index'));\n                this.$('.RecipientsInput').trigger('focus');\n              }}\n            >\n              {!this.doSearch\n                ? LoadingIndicator.component({ size: 'tiny', className: 'Button Button--icon Button--link' })\n                : this.sources.map((source) => source.view(this.value()))}\n              <li>\n                <span>{app.translator.trans('nodeloc-whisper.forum.modal.more_users')}</span>\n              </li>\n            </ul>\n          </div>\n        ) : (\n          <div className=\"RecipientsInput-selected RecipientsLabel\">\n            {recipientLabel(app.cache.conversationsRecipient, {\n              onclick: () => {\n                this.removeRecipient(app.cache.conversationsRecipient);\n              },\n            })}\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  /**\n   * Build an item list of SearchSources.\n   *\n   * @return {ItemList}\n   */\n  sourceItems() {\n    const items = new ItemList();\n\n    items.add('users', new UserSearchSource());\n\n    return items;\n  }\n\n  /**\n   * Clear the search input and the current controller's active search.\n   */\n  clear() {\n    this.value('');\n\n    m.redraw();\n  }\n\n  /**\n   * Adds a recipient.\n   *\n   * @param value\n   */\n  addRecipient(value) {\n    app.cache.conversationsRecipient = app.store.getById('users', value);\n\n    this.clear();\n  }\n\n  /**\n   * Removes a recipient.\n   *\n   * @param recipient\n   */\n  removeRecipient(recipient) {\n    app.cache.conversationsRecipient = null;\n\n    m.redraw();\n  }\n\n  /**\n   * Loads a recipient from the global store.\n   *\n   * @param store\n   * @param id\n   * @returns {Model}\n   */\n  findRecipient(store, id) {\n    return app.store.getById(store, id);\n  }\n}\n","import Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport RecipientSearch from './RecipientSearch';\nimport username from 'flarum/common/helpers/username';\nimport Stream from 'flarum/common/utils/Stream';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport app from 'flarum/forum/app';\n\nexport default class StartConversationModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n\n    app.cache.conversationsRecipient = null;\n\n    this.conversations = this.attrs.conversations;\n\n    this.already = false;\n\n    this.messageContent = Stream('');\n    if(!this.conversations) this.conversations = [];\n  }\n\n  title() {\n    return app.translator.trans('nodeloc-whisper.forum.modal.title');\n  }\n\n  className() {\n    return 'StartConversationModal Modal--medium';\n  }\n\n  content() {\n    return [\n      <div className=\"Modal-body\">\n        {this.already ? [\n          <h2>{app.translator.trans('nodeloc-whisper.forum.modal.already', {username: username(this.attrs.user)})}</h2>,\n          <h2>{app.translator.trans('nodeloc-whisper.forum.modal.copied', {username: username(this.attrs.user)})}</h2>\n          ] :\n          <div>\n            <div class=\"helpText\">\n              {app.translator.trans('nodeloc-whisper.forum.modal.help_start', {username: username(this.attrs.user)})}\n            </div>\n            <div className=\"AddRecipientModal-form\">\n\n                <div className=\"AddRecipientModal-form-submit\">\n                  <textarea value={this.messageContent()} oninput={withAttr('value', this.messageContent)} placeholder={app.translator.trans('nodeloc-whisper.forum.chat.text_placeholder')} rows=\"3\"></textarea>\n                  {Button.component({\n                    type: 'submit',\n                    className: 'Button Button--primary',\n                    disabled: !this.messageContent(),\n                  }, app.translator.trans('nodeloc-whisper.forum.modal.submit')\n                  )}\n                </div>\n            </div>\n          </div>\n        }\n      </div>\n    ];\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n\n    const recipient = this.attrs.user;\n    this.recpient = recipient;\n    app.cache.conversationsRecipient = null;\n\n    app.store.createRecord('conversations')\n      .save({\n        messageContents: this.messageContent(),\n        recipient: recipient.id(),\n      }).then(conversation => {\n      if (!conversation.notNew()) {\n        this.conversations.push(conversation);\n        const preconv = app.session.user.conversations();\n        preconv.push(conversation);\n        app.session.user.conversations = Stream(preconv);\n        m.redraw();\n        app.modal.close();\n      } else {\n        console.log(conversation);\n        m.redraw();\n        app.modal.close();\n      }\n    })\n  }\n}\n","import Button from 'flarum/common/components/Button';\nimport Component from 'flarum/common/Component';\nimport ConversationView from './ConversationView';\nimport UserListItem from './UserListItem';\nimport StartConversationModal from './StartConversationModal';\nimport app from 'flarum/forum/app';\n\nexport default class ConversationsList extends Component {\n  oninit(vnode) {\n    this.mobile = vnode.attrs.mobile;\n    this.load();\n    this.loading = false;\n    this.currentConversation = null;\n  }\n\n  onupdate() {}\n\n  onbeforeupdate() {\n    const list = $('.ConversationsList-list');\n\n    list.off('scroll').on('scroll', () => {\n      if (list.scrollTop() + list.innerHeight() >= list[0].scrollHeight) {\n        this.loadMore();\n      }\n    });\n  }\n\n  view() {\n    if (this.loading) return;\n    if (!app.cache.conversations) return;\n    const conversations = app.cache.conversations;\n\n    if (this.currentConversation === null && app.cache.conversations && app.cache.conversations.length > 0) {\n      this.currentConversation = app.cache.conversations[0];\n    }\n\n    if (this.currentConversation) {\n      this.conversationComponent = ConversationView.component({ conversation: this.currentConversation, mobile: this.mobile });\n    }\n\n    return (\n      <div className=\"ConversationsList\">\n        <div style={conversations.length ? '' : 'width: unset; padding: 10px;'} className=\"container clearfix\">\n          <div style={this.mobile ? 'float: unset; margin: 0 auto; display: block;' : ''} className=\"people-list\" id=\"people-list\">\n            {!!conversations.length && (\n              <ul className=\"ConversationsList-list\">\n                {Array.isArray(conversations) &&\n                  conversations.map((conversation, i) => {\n                    return (\n                      <UserListItem\n                        conversation={conversation}\n                        i={i}\n                        active={this.mobile ? false : this.currentConversation === conversation}\n                        onclick={(e) => {\n                          if (this.mobile) {\n                            m.route(app.route('messages', { id: app.cache.conversations[$(e.currentTarget).attr('id')].id() }));\n                          } else {\n                            this.currentConversation = app.cache.conversations[$(e.currentTarget).attr('id')];\n                            m.redraw();\n                          }\n                        }}\n                      />\n                    );\n                  })}\n              </ul>\n            )}\n          </div>\n\n          {!this.mobile && this.conversationComponent}\n        </div>\n      </div>\n    );\n  }\n\n  showModal() {\n    app.modal.show(StartConversationModal, {\n      conversations: app.cache.conversations,\n      messages: app.cache.messages,\n    });\n  }\n\n  loadMore() {\n    this.loading = true;\n    m.redraw();\n\n    app.store\n      .find('whisper/conversations', { offset: app.cache.conversations.length })\n      .then((results) => {\n        delete results.payload;\n        results.map((result) => {\n          app.cache.conversations.push(result);\n        });\n      })\n      .catch(() => {})\n      .then(() => {\n        this.loading = false;\n        m.redraw();\n      });\n  }\n\n  load() {\n    if (app.cache.conversations && !this.mobile) {\n      return;\n    }\n\n    if (this.mobile) {\n      app.cache.conversations = [];\n    }\n\n    this.loading = true;\n    m.redraw();\n\n    app.store\n      .find('whisper/conversations')\n      .then((results) => {\n        delete results.payload;\n        app.cache.conversations = results;\n      })\n      .catch(() => {})\n      .then(() => {\n        this.loading = false;\n        m.redraw();\n      });\n  }\n}\n","import Page from 'flarum/common/components/Page';\n\nimport ConversationsList from './ConversationsList';\n\nexport default class ConversationsPage extends Page {\n  oninit() {\n    super.oninit();\n\n    app.history.push('messages');\n\n    this.bodyClass = 'App--conversations';\n  }\n\n  view() {\n    return (\n      <div className=\"ConversationsPage\">\n        <ConversationsList mobile={true}></ConversationsList>\n      </div>\n    );\n  }\n}\n","import Page from 'flarum/common/components/Page';\n\nimport ConversationView from './ConversationView';\n\nexport default class ConversationViewPage extends Page {\n  init() {\n    super.init();\n\n    app.history.push('conversations');\n\n    const idParam = m.route.param('id');\n\n    app.store.find('whisper/conversations', idParam).then((conversation) => {\n      app.cache.conversations = [];\n      app.cache.conversations.push(conversation);\n      this.list = ConversationView.component({ conversation, mobile: true });\n      m.redraw();\n    });\n\n    this.bodyClass = 'App--messages';\n  }\n\n  view() {\n    return (\n      <div className=\"MessagesPage\">\n        <div className=\"ConversationsList\">\n          <div className=\"container clearfix\">{this.list ? this.list : null}</div>\n        </div>\n      </div>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['utils/UserControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/HeaderSecondary'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/NotificationsDropdown'];","import app from 'flarum/forum/app';\nimport NotificationsDropdown from 'flarum/forum/components/NotificationsDropdown';\n\nimport ConversationsList from './ConversationsList';\n\nexport default class ConversationsDropdown extends NotificationsDropdown {\n  static initAttrs(attrs) {\n    attrs.label ||= attrs.label || app.translator.trans('nodeloc-whisper.forum.dropdown.tooltip');\n    attrs.icon ||= 'fas fa-comment-alt';\n    attrs.className = 'MessagesDropdown NotificationsDropdown';\n\n    super.initAttrs(attrs);\n  }\n\n  onclick() {\n    if (app.drawer.isOpen()) {\n      this.goToRoute();\n    }\n  }\n\n  getMenu() {\n    return (\n      <form className={'Dropdown-menu ' + this.attrs.menuClassName}>\n        {!!this.showing && <ConversationsList mobile={false}/>}\n      </form>\n    );\n  }\n\n  goToRoute() {\n    m.route(app.route('conversations'));\n  }\n\n  getUnreadCount() {\n    return app.session.user.unreadMessages();\n  }\n\n  getNewCount() {\n    return app.session.user.unreadMessages();\n  }\n}\n","import app from 'flarum/app';\nimport {extend} from 'flarum/extend';\nimport IndexPage from 'flarum/components/IndexPage';\nimport Message from './models/Message';\nimport Conversation from './models/Conversation';\nimport ConversationUser from './models/ConversationUser';\nimport User from 'flarum/models/User';\nimport Model from 'flarum/Model';\nimport ConversationsPage from './components/ConversationsPage';\nimport ConversationViewPage from './components/ConversationViewPage';\nimport Stream from 'flarum/utils/Stream';\nimport UserControls from 'flarum/utils/UserControls';\nimport Button from 'flarum/components/Button';\n\nimport addConversationsDropdown from './addConversationsDropdown'\nimport StartConversationModal from \"./components/StartConversationModal\";\n\napp.initializers.add('nodeloc-whisper', function (app) {\n  app.store.models.messages = Message;\n  app.store.models.conversations = Conversation;\n  app.store.models.conversation_users = ConversationUser;\n\n  User.prototype.conversations = Model.hasMany('conversations');\n  User.prototype.unreadMessages = Model.attribute('unreadMessages');\n\n  app.routes.conversations = { path: '/whisper/conversations', component: ConversationsPage };\n  app.routes.messages = { path: '/whisper/messages/:id', component: ConversationViewPage };\n\n  addConversationsDropdown();\n\n  extend(IndexPage.prototype, 'oncreate', function () {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        if (channels.user) {\n          channels.user.bind('newMessage', (data) => {\n            app.session.user.unreadMessages = Stream(app.session.user.unreadMessages() + 1);\n            m.redraw();\n          });\n        }\n      });\n    }\n  });\n\n  extend(IndexPage.prototype, 'onremove', function () {\n    if (app.pusher) {\n      app.pusher.then((object) => {\n        const channels = object.channels;\n        if (channels.user) {\n          channels.user.unbind('newMessage');\n        }\n      });\n    }\n  })\n  extend(UserControls, 'moderationControls', (items, user) => {\n    if (app.forum.attribute('canMessage')) {\n      items.add('newMessage', Button.component({\n        icon: 'fas fa-money-bill',\n        onclick: () => app.modal.show(StartConversationModal, {user})\n      }, app.translator.trans('nodeloc-whisper.forum.chat.chat_with')));\n    }\n  });\n});\n","import { extend } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport HeaderSecondary from 'flarum/forum/components/HeaderSecondary';\nimport ConversationsDropdown from './components/ConversationsDropdown';\n\nexport default function () {\n  extend(HeaderSecondary.prototype, 'items', function (items) {\n    if (app.forum.attribute('canMessage') || (app.session.user && app.session.user.conversations().length)) {\n      items.add('Messages', <ConversationsDropdown />, 20);\n    }\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Message","_mixin","apply","arguments","apiEndpoint","this","exists","data","id","mixin","Model","message","user","isHidden","createdAt","conversation","number","Conversation","messages","recipients","totalMessages","notNew","updatedAt","ConversationUser","userId","conversationId","lastRead","MessageText","_Component","initAttrs","attrs","className","content","preview","_proto","view","m","oncreate","vnode","_this","updatePreview","s9e","TextFormatter","dom","updateInterval","setInterval","onremove","clearInterval","Component","ConversationView","oninit","loading","mobile","idParam","route","param","firstLoad","typingTimeout","sendTimeout","interval3","timer","redraw","setTimeout","interval1","interval2","typingTime","Date","now","typing","initPost","newMessageCount","load","messageContent","Stream","Promise","$","animate","scrollTop","app","then","object","channels","unbind","onupdate","_this2","scroll","firstMsg","getMessages","length","offset","top","onbeforeupdate","_this3","off","on","e","conversations","currentTarget","attr","index","cipher","keyCode","attribute","sendMessage","_this4","parseInt","children","is","decryptMessages","list","scrollMore","innerHeight","scrollHeight","recipient","_this5","style","avatar","trans","username","count","filter","self","findIndex","t","sort","b","map","i","myMessage","humanTime","attributes","icon","LoadingIndicator","display","size","oninput","withAttr","typingPush","placeholder","rows","Button","onclick","disabled","_this6","method","url","body","_this7","replace","createRecord","save","messageContents","push","messageId","_this8","find","results","_app$cache$messages$_","payload","oldNumber","meRecipient","response","newNumber","unreadMessages","lastUnreadMessage","pushAttributes","_this9","UserListItem","active","userOnline","StartConversationModal","_Modal","conversationsRecipient","already","title","class","type","onsubmit","preventDefault","recpient","console","log","close","preconv","Modal","ConversationsList","currentConversation","loadMore","conversationComponent","component","Array","isArray","showModal","show","result","ConversationsPage","_Page","history","bodyClass","Page","ConversationViewPage","init","store","cache","ConversationsDropdown","_NotificationsDropdow","label","isOpen","goToRoute","getMenu","menuClassName","showing","getUnreadCount","getNewCount","NotificationsDropdown","add","models","conversation_users","User","routes","path","extend","HeaderSecondary","items","IndexPage","pusher","session","UserControls","forum","modal","translator"],"sourceRoot":""}